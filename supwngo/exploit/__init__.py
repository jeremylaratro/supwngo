"""Exploit generation modules."""

from supwngo.exploit.generator import ExploitGenerator, Exploit
from supwngo.exploit.primitives import ExploitPrimitive
from supwngo.exploit.shellcode import ShellcodeGenerator
from supwngo.exploit.bypass import (
    ProtectionBypass,
    BypassStrategy,
    PartialOverwrite,
    PartialOverwriteResult,
)
from supwngo.exploit.fsop import IOFile, FSOPExploiter
from supwngo.exploit.seccomp import SeccompAnalyzer, SeccompBypass
from supwngo.exploit.got_plt import GOTAnalyzer, GOTOverwriter, PLTHijacker
from supwngo.exploit.constrained_shellcode import (
    ConstrainedShellcodeGenerator,
    ShellcodeConstraints,
)
from supwngo.exploit.canary_bypass import (
    addr_to_double,
    double_to_addr,
    ScanfBypassExploit,
    generate_scanf_bypass_script,
    generate_canary_leak_script,
)
from supwngo.exploit.format_string import (
    FormatStringExploiter,
    FormatStringAutoExploit,
    OneShotExploit,
    ArbitraryWrite,
    WriteSize,
    FormatStringInfo,
    BadCharConfig,
    find_fmt_offset,
    fmt_leak,
    fmt_write,
    fmt_got_overwrite,
    fmt_multi_write,
)
from supwngo.exploit.signal_handler import (
    SignalHandlerAnalyzer,
    SignalHandlerExploiter,
    LongjmpCorruptor,
    SignalHandlerInfo,
    SignalExploitPlan,
    generate_signal_race_exploit,
)
from supwngo.exploit.ld_preload import (
    LDPreloadGenerator,
    LDPreloadExploitFinder,
    PreloadPayload,
    FunctionHook,
    HookType,
    generate_preload_exploit,
)
from supwngo.exploit.chainer import (
    ExploitChainer,
    ExploitChain,
    ChainLink,
    ChainStage,
    Primitive,
    PrimitiveType,
    TechniqueRegistry,
    chain_primitives,
    suggest_techniques,
)
# Phase 3: Reliability modules
from supwngo.exploit.verify import (
    ExploitVerifier,
    VerificationReport,
    VerificationResult,
    BadCharFinder,
    verify_payload,
)
from supwngo.exploit.libc_auto import (
    LibcAutomation,
    LibcMatch,
    LibcAnalysis,
    LeakChainBuilder,
    identify_libc,
)
from supwngo.exploit.pie_bypass import (
    PIEBypassAutomation,
    PIEBypassStrategy,
    PIEBypassType,
    BruteForceHelper,
    PartialOverwriteBuilder,
    analyze_pie_bypass,
)
# Phase 4: Advanced techniques
from supwngo.exploit.brop import (
    BROPExploiter,
    BROPOracle,
    BROPState,
    BROPGadget,
    StackCanaryLeaker,
    StopGadgetFinder,
    BROPGadgetFinder,
    PLTFinder,
    ProbeResult,
)
from supwngo.exploit.seccomp_advanced import (
    AdvancedSeccompAnalyzer,
    SeccompAnalysis,
    SeccompAction,
    SeccompRule,
    BypassStrategy as SeccompBypassStrategy,
    ORWChainBuilder,
    SyscallCategory,
)
# Auto leak finder
from supwngo.exploit.auto_leak import (
    AutoLeakFinder,
    LeakPrimitive,
    LeakType,
    LeakMethod,
    LeakResult,
    find_leaks,
    auto_leak,
)
# Exploit testing
from supwngo.exploit.tester import (
    ExploitTester,
    ExploitTestResult,
    TestResult,
    TestConfig,
    TestEnvironment,
    ExploitValidator,
    test_exploit,
)

# ROP module exports (for convenience)
from supwngo.exploit.rop import (
    GadgetFinder,
    Gadget,
    GadgetType,
    ROPChainBuilder,
    ROPChain,
    StackPivot,
    PivotType,
    PivotGadget,
    PivotPayload,
)
# Advanced bypass modules
from supwngo.exploit.advanced_bypass import (
    CFIAnalyzer,
    CFIBypass,
    CFIType,
    CFIInfo,
    COOPGadget,
    VTableInfo,
    IndirectCallSite,
    find_cfi_bypasses,
    CETAnalyzer,
    CETBypass,
    CETInfo,
    ShadowStackBypass,
    SignalBasedBypass,
    IBTBypass,
    CETExploitStrategy,
    analyze_cet_protection,
)
# Payload synthesis
from supwngo.exploit.payload_synthesis import (
    PayloadSynthesizer,
    PayloadConstraints,
    SynthesizedPayload,
    PayloadType,
    ConstraintSolver as PayloadConstraintSolver,
    synthesize_payload,
)

__all__ = [
    "ExploitGenerator",
    "Exploit",
    "ExploitPrimitive",
    "ShellcodeGenerator",
    # Protection bypass
    "ProtectionBypass",
    "BypassStrategy",
    "PartialOverwrite",
    "PartialOverwriteResult",
    # FSOP
    "IOFile",
    "FSOPExploiter",
    # Seccomp
    "SeccompAnalyzer",
    "SeccompBypass",
    # GOT/PLT
    "GOTAnalyzer",
    "GOTOverwriter",
    "PLTHijacker",
    # Constrained Shellcode
    "ConstrainedShellcodeGenerator",
    "ShellcodeConstraints",
    # Canary bypass
    "addr_to_double",
    "double_to_addr",
    "ScanfBypassExploit",
    "generate_scanf_bypass_script",
    "generate_canary_leak_script",
    # ROP (convenience exports)
    "GadgetFinder",
    "Gadget",
    "GadgetType",
    "ROPChainBuilder",
    "ROPChain",
    "StackPivot",
    "PivotType",
    "PivotGadget",
    "PivotPayload",
    # Format string exploitation
    "FormatStringExploiter",
    "FormatStringAutoExploit",
    "OneShotExploit",
    "ArbitraryWrite",
    "WriteSize",
    "FormatStringInfo",
    "BadCharConfig",
    "find_fmt_offset",
    "fmt_leak",
    "fmt_write",
    "fmt_got_overwrite",
    "fmt_multi_write",
    # Signal handler exploitation
    "SignalHandlerAnalyzer",
    "SignalHandlerExploiter",
    "LongjmpCorruptor",
    "SignalHandlerInfo",
    "SignalExploitPlan",
    "generate_signal_race_exploit",
    # LD_PRELOAD exploitation
    "LDPreloadGenerator",
    "LDPreloadExploitFinder",
    "PreloadPayload",
    "FunctionHook",
    "HookType",
    "generate_preload_exploit",
    # Technique chaining
    "ExploitChainer",
    "ExploitChain",
    "ChainLink",
    "ChainStage",
    "Primitive",
    "PrimitiveType",
    "TechniqueRegistry",
    "chain_primitives",
    "suggest_techniques",
    # Phase 3: Reliability
    "ExploitVerifier",
    "VerificationReport",
    "VerificationResult",
    "BadCharFinder",
    "verify_payload",
    "LibcAutomation",
    "LibcMatch",
    "LibcAnalysis",
    "LeakChainBuilder",
    "identify_libc",
    "PIEBypassAutomation",
    "PIEBypassStrategy",
    "PIEBypassType",
    "BruteForceHelper",
    "PartialOverwriteBuilder",
    "analyze_pie_bypass",
    # Phase 4: BROP
    "BROPExploiter",
    "BROPOracle",
    "BROPState",
    "BROPGadget",
    "StackCanaryLeaker",
    "StopGadgetFinder",
    "BROPGadgetFinder",
    "PLTFinder",
    "ProbeResult",
    # Phase 4: Advanced Seccomp
    "AdvancedSeccompAnalyzer",
    "SeccompAnalysis",
    "SeccompAction",
    "SeccompRule",
    "SeccompBypassStrategy",
    "ORWChainBuilder",
    "SyscallCategory",
    # Auto leak finder
    "AutoLeakFinder",
    "LeakPrimitive",
    "LeakType",
    "LeakMethod",
    "LeakResult",
    "find_leaks",
    "auto_leak",
    # Exploit testing
    "ExploitTester",
    "ExploitTestResult",
    "TestResult",
    "TestConfig",
    "TestEnvironment",
    "ExploitValidator",
    "test_exploit",
    # Advanced bypass: CFI
    "CFIAnalyzer",
    "CFIBypass",
    "CFIType",
    "CFIInfo",
    "COOPGadget",
    "VTableInfo",
    "IndirectCallSite",
    "find_cfi_bypasses",
    # Advanced bypass: CET
    "CETAnalyzer",
    "CETBypass",
    "CETInfo",
    "ShadowStackBypass",
    "SignalBasedBypass",
    "IBTBypass",
    "CETExploitStrategy",
    "analyze_cet_protection",
    # Payload synthesis
    "PayloadSynthesizer",
    "PayloadConstraints",
    "SynthesizedPayload",
    "PayloadType",
    "PayloadConstraintSolver",
    "synthesize_payload",
]
